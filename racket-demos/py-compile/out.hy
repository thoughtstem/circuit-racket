(import express) (import tslib) (import (tslib (*))) (setv main-color (if True (, 0 255 0) "green")) (defn update () (global main-color) (global state) (do (if (shake 10) (angry) (flicker)))) (defn setup () (global main-color) (global state) (do (play-riff (, (, 261.63 0.125) (, 293.66 0.125) (, 659.25 0.125) (, 698.46 0.125) (, 783.99 0.125) (, 880.0 0.125))) (set-brightness 0.5) (setv main-color (if True (, 0 0 255) "blue")) (set-lights main-color) (do (enable-touch-a1 False) (set-servo-f board.A1 90)))) (defn angry () (global main-color) (global state) (do (for (n (range (int (* 12 (random.random))))) (set-brightness 1) (do (enable-touch-a1 False) (set-servo-f board.A1 (* 180 (random.random)))) (set-lights (if True (, 255 0 0) "red")) (do (time.sleep 0.025) (express.cpx.pixels.show)) (set-lights (if True (, 0 0 0) "black")) (play-tone (pick-random 100 500) 0.1) (do (time.sleep 0.01) (express.cpx.pixels.show))) (do (time.sleep 0.5) (express.cpx.pixels.show)) (do (enable-touch-a1 False) (set-servo-f board.A1 90)))) (defn flicker () (global main-color) (global state) (do (set-brightness (random.random)) (do (time.sleep (/ (random.random) 20)) (express.cpx.pixels.show)) (set-lights main-color) (do (enable-touch-a1 False) (set-servo-f board.A1 90)))) (setup) (while True (update-buttons) (ir-receive) (update))